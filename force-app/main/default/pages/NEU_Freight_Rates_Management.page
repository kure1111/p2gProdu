<apex:page id="page" controller="NEU_Freight_Rates_Management" sidebar="false">
    <apex:includeScript value="{!$Resource.jquery_1_11_1}"/> 
    <apex:includeScript value="{!$Resource.jquery_ui_1_11_4}"/>
    <apex:includeScript value="{!$Resource.neurored_jquery}"/> 
    <apex:includeScript value="{!$Resource.NEU_Select_js}"/> 
    <apex:stylesheet value="{!URLFOR($Resource.jquery_ui_1_11_4_css,'jquery-ui.min.css')}"/>
    <apex:stylesheet value="{!$Resource.NEU_Pagination_css}"/>
    <apex:stylesheet value="{!$Resource.NEU_Select_css}"/>
<style>
    input.pasted
    {
        background-color:#FFFACD!important;
    }
</style>
      <script type="text/javascript">
        $(document).ready(function () {
            setDecimalSep($('#page\\:form\\:decimalSep').val(),$('#page\\:form\\:thousandSep').val());
            setTable();
        });
        function clearSelection()
        {
            if (window.getSelection) {
              if (window.getSelection().empty) {  // Chrome
                window.getSelection().empty();
              } else if (window.getSelection().removeAllRanges) {  // Firefox
                window.getSelection().removeAllRanges();
              }
            } else if (document.selection) {  // IE?
              document.selection.empty();
            }
        }
        function launchCopy(elem,e)
        {
            clearSelection();
            var range=document.createRange();  
            range.selectNode(elem);
            window.getSelection().addRange(range);        
            document.execCommand("copy");
            clearSelection();
            e.preventDefault();
        }
        function makeCopy(e)
        {
            var tocopy='<table>';
            var totext='';
            $('tr',$('#mytable')).each(function(a,tr){
                var tempcopy='';
                var temptext='';
                var firstd=true;
                $('th',tr).each(function(a,td){
                    if($('input.copytoclipboard',td).length>0)
                    {
                        tempcopy+='<td style="font-weight:bold">'+$('input.copytoclipboard',td).val()+'</td>';
                        if(firstd)
                        {
                            temptext=$('input.copytoclipboard',td).val();
                            firstd=false;
                        }
                        else
                            temptext+=','+$('input.copytoclipboard',td).val();
                    }
                    else if($('.copytoclipboard',td).length>0)
                    {
                        tempcopy+='<td style="font-weight:bold">'+$('.copytoclipboard',td).text()+'</td>';
                        if(firstd)
                        {
                            temptext=$('.copytoclipboard',td).text();
                            firstd=false;
                        }
                        else
                            temptext+=','+$('.copytoclipboard',td).text();
                    }
                });
                $('td',tr).each(function(a,td){
                    if($('input.copytoclipboard',td).length>0)
                    {
                        tempcopy+='<td>'+$('input.copytoclipboard',td).val()+'</td>';
                        if(firstd)
                        {
                            temptext=$('input.copytoclipboard',td).val();
                            firstd=false;
                        }
                        else
                            temptext+=','+$('input.copytoclipboard',td).val();
                    }
                    else if($('.copytoclipboard',td).length>0)
                    {
                        tempcopy+='<td>'+$('.copytoclipboard',td).text()+'</td>';
                        if(temptext)
                        if(firstd)
                        {
                            temptext=$('input.copytoclipboard',td).text();
                            firstd=false;
                        }
                        else
                            temptext+=','+$('input.copytoclipboard',td).text();
                    }
                });
                if(tempcopy)
                    tocopy+='<tr>'+tempcopy+'</tr>';
                if(temptext)
                    if(totext)
                        totext+='\r\n'+temptext;
                    else
                        totext=temptext;
            });
            tocopy+='</table>';
            e.clipboardData.setData("text/html",tocopy);
            e.clipboardData.setData("text/plain",totext);
            e.preventDefault();
            alert('Your data has been copied to the clipboard');
        }
        function setTable()
        {
            $('span.Rate_Type select').attr('copyclass','copytoclipboard');
            $('span.Rate_Type select,select.Fee_Category,input.Port_Airport_of_Load,input.Port_Airport_of_Discharge,select.Country_of_Load,select.Country_of_Discharge').NEUselect();
            $('input.mg0,input.mg1,input.mg2,input.mg3').each(function(){
                if($(this).getString()!='')
                    $(this).setFloatSep($(this).getFloatSep().toFixed(2));
            });
        }
        function finishpaste(mytr,mycolumn){
            $('#pastediv tr').each(function(a,pastetr){
                if(mytr.length<1)
                    return false;
                var mytds=$('td',mytr);
                $('td',pastetr).each(function(pastecolumn,pastetd){
                    if(mytds.length<=pastecolumn+mycolumn)
                        return false;
                    var text=$(pastetd).text().replace(/\s\s+/g, ' ').trim();
                    $('input[type=text],textarea',mytds[pastecolumn+mycolumn]).each(function(a,e){
                        var e=$(e);
                        if(e.is('input.es-input'))
                        {
                            e.addClass('pasted').NEUselectSetText(text);
                        }
                        else if(e.val(text).addClass('pasted').is('select'))
                            if(e.val()!=text)
                                e.append($("<option></option>").attr("value",text).text(text)).val(text);
                    });
                });
                mytr=mytr.next('tr');
            });
        }
        var linesTableId;
        var linesRow;
        var linesCol;
        function linesComplete(){
            var mytrs=$('tr',$($.sfId(linesTableId)));
            if(mytrs.length>linesRow)
                finishpaste($(mytrs[linesRow]),linesCol);
        }
        function handlepaste(elem,e) {
            $('.pasted').removeClass('pasted');
            if (e && e.clipboardData && e.clipboardData.getData) {
                if (/text\/html/.test(e.clipboardData.types)) {
                    $('#pastediv').html(e.clipboardData.getData('text/html'));
                    $('#pastediv td[colspan]').not('[colspan=1]').each(function(a,mytd){
                        mytd=$(mytd);
                        var colspan=mytd.attr('colspan');
                        while(colspan>1)
                        {
                            mytd.after("<td></td>");
                            colspan--;
                        }
                        mytd.attr('colspan',1);
                    });
                    elem=$(elem).closest('td');
                    var mycolumn=elem.prevAll('td').size();
                    elem=$(elem).closest('tr');
                    var needtr=$('#pastediv tr').length-elem.nextAll('tr').length-1;
                    if((needtr>0)||(mycolumn==0))
                    {
                        var mytable=elem.closest('table');
                        linesTableId=neu_getId(mytable);
                        var mytrid=neu_getId(elem);
                        $('tr',mytable).each(function(myrow,mytr){
                            if(neu_getId(mytr)==mytrid)
                            {
                                linesRow=myrow;
                                return false;
                            }
                        });
                        linesCol=mycolumn;
                        if(mycolumn==0)
                        {
                            var idLines=null;
                            $('#pastediv tr').each(function(a,pastetr){
                                var pastetds=$('td',pastetr);
                                if(pastetds.length>0)
                                {
                                    if(idLines==null)
                                        idLines=$(pastetds[0]).text().replace(/\s\s+/g, ' ').trim();
                                    else
                                        idLines=idLines+'_|_'+$(pastetds[0]).text().replace(/\s\s+/g, ' ').trim();
                                }
                            });
                            orderLines(idLines,linesRow-1);
                        }
                        else
                            addLines(needtr);
                    }
                    else
                        finishpaste(elem,mycolumn);
                    if (e.preventDefault) {
                        e.stopPropagation();
                        e.preventDefault();
                    }
                    return false;
                }
                else if (/text\/plain/.test(e.clipboardData.types)) {
                    $(elem).val(e.clipboardData.getData('text/plain')).addClass('pasted');
                    if (e.preventDefault) {
                        e.stopPropagation();
                        e.preventDefault();
                    }
                    return false;
                }
            }
        }
        function validationOK(value,value0,value1,value2,value3,value4,value5,value6,value7,value8,value9)
        {
            if($('#page\\:form\\:validationOK').val())
                value(value0,value1,value2,value3,value4,value5,value6,value7,value8,value9);
        }
        function applymargin(classname)
        {
            if($('input.ap'+classname).getString()!='')
            {
                var m=$('input.ap'+classname).getFloatSep();
                if(m<100)
                {
                    $('input.mg'+classname).setFloatSep(m.toFixed(2));
                    $('input.mg'+classname).updateSell(classname);
                    $('input.ap'+classname).val('');
                }
            }
        }
        (function($) {
            $.fn.updateSell = (function(classname) {
                this.each(function(){
                    if($(this).getString()!='')
                    {
                        var m=$(this).getFloatSep();
                        if(m<100)
                        {
                            var tr=$(this).closest('tr');
                            $('input.sell'+classname,tr).setFloatSep(($('input.buy'+classname,tr).getFloatSep()/(1-($(this).getFloatSep()/100))).toFixed(2));
                        }
                    }
                });
            });
        })(jQuery);
        (function($) {
            $.fn.updateSellfBuy = (function(classname) {
                this.each(function(){
                    var b=$(this).getFloatSep();
                    var tr=$(this).closest('tr');
                    var s=$('input.sell'+classname,tr).getFloatSep();
                    if(s!=0)
                        $('input.mg'+classname,tr).setFloatSep((((s-b)/s)*100).toFixed(2));
                    else
                        $('input.mg'+classname,tr).val('');
                });
            });
        })(jQuery);
        (function($) {
            $.fn.updateMargin = (function(classname) {
                this.each(function(){
                    var s=$(this).getFloatSep();
                    var tr=$(this).closest('tr');
                    var b=$('input.buy'+classname,tr).getFloatSep();
                    if(s!=0)
                        $('input.mg'+classname,tr).setFloatSep((((s-b)/s)*100).toFixed(2));
                    else
                        $('input.mg'+classname,tr).val('');
                });
            });
        })(jQuery);
        
        function get_message(id_service, id_carrier, info_type)
		{
			$(".main_info").css("display","none");
			$(".main_header").css("display","none");
			
			var position;
			
			if(info_type == "carrier_info")
				position = $(".carrier_account_"+id_service).position();
			if(info_type == "buy_rate_1")
				position = $(".buy_rate_1_"+id_service).position();
			if(info_type == "buy_rate_2")
				position = $(".buy_rate_2_"+id_service).position();
			if(info_type == "sell_rate_1")
				position = $(".sell_rate_1_"+id_service).position();
			if(info_type == "sell_rate_2")
				position = $(".sell_rate_2_"+id_service).position();
			
			$(".alert_message").css("display","block");
			$(".alert_message").css("top",position.top - 8);
			$(".alert_message").css("left",position.left -396);
		
			document.getElementById('{!$Component.form.id_service}').value = id_service;
			document.getElementById('{!$Component.form.id_carrier}').value = id_carrier;
			document.getElementById('{!$Component.form.info_type}').value = info_type;
			document.getElementById('{!$Component.form.buy_rate_filter}').value = ($(".buy_rate_1_"+id_service).parent().find(".b0").val() != null ? $(".buy_rate_1_"+id_service).parent().find(".b0").getFloatSep() : 0);
			document.getElementById('{!$Component.form.sell_rate_filter}').value = ($(".sell_rate_1_"+id_service).parent().find(".s0").val() != null ? $(".sell_rate_1_"+id_service).parent().find(".s0").getFloatSep() : 0);
			
			if(info_type == "carrier_info")
				get_carrier_contact_details();
			if(info_type == "buy_rate_1" || info_type == "buy_rate_2" || info_type == "sell_rate_1" || info_type == "sell_rate_2")
				get_historical_prices();
		}
		
		function show_message()
		{
			$(".main_info").css("display","block");
			$(".main_header").css("display","inline");
		}
		
		function close_message()
		{
			$(".alert_message").css("display","none");
		}
    </script>
    <style>
    	#alert_message{display:none; padding: 3px 6px 5px; margin-top: -12px; margin-right: 0; margin-bottom: 0; margin-left: -11px; background: transparent url(/img/sprites/hover_sprite.png) 15px -29px no-repeat; text-align:left;}
		#custom_style_right{background: transparent url({!URLFOR($Resource.hover_arrow_right)}) 383px 3px no-repeat; width: 370px; padding-left: 15px; padding-right: 15px; border: 0; margin: 0;}
		#custom_style_header{border-top: 3px solid #3f6075; margin: 0; border-radius: 4px; padding:6px 10px; color: rgb(51, 52, 53); font-family: Arial, Helvetica, sans-serif; font-size: 14px; font-weight: bold;}
		#custom_style_body{font-family: Arial, Helvetica, sans-serif; font-size: 12px;}
		#custom_style_footer{background: transparent url(/img/sprites/hover_sprite.png) no-repeat; display: block; position: absolute; width: 100%; height: 14px; bottom: -14px; left: 15px;}
		.campo_azul{cursor:pointer; color:#015ba7 !important; text-decoration:underline !important;}
		.cierre{float: right; display: block; cursor: pointer; background: #3f6075; color: #ffffff; padding: 3px; border-radius: 3px; cursor:pointer; font-size:10px;}
		.board_image{margin:0 5px 0 0; cursor: pointer;}
		.message_icon{height:25px;}
		#alert_message .td_icon{text-align:center; width: 60px;}
		#alert_message .td_text{font-size: 11px;}
		.carrier_account{width:160px;}
		.leyenda{float: left; margin-right: 30px; margin-top: 0;}
		.texto_leyenda{float: right; margin: 2px 0 2px 5px;}
		.table_data{border: 1px solid #3f6075 !important; margin-bottom:5px;}
		.table_data .dataRow th
		{
			background: #f2f3f3;
		    border-width: 0 0 1px 1px;
		    border-color: #e0e3e5;
		    color: #000;
		    font-size: .9em;
		    font-weight: bold;
		    padding: 5px 2px 4px 5px;
			border: 1px solid #ededed;
		}
    </style>
    <apex:form id="form">
    <apex:inputHidden value="{!decimalSep}" id="decimalSep"/>
    <apex:inputHidden value="{!thousandSep}" id="thousandSep"/>
    <apex:actionFunction name="sorting" action="{!sorting}" status="myStatus" reRender="pageblock,errors" oncomplete="setTable();">
        <apex:param name="one" assignTo="{!compareField}" value="" />
        <apex:param name="two" assignTo="{!sortList}" value="" />
    </apex:actionFunction>
    <apex:actionFunction name="addLines" action="{!addLines}" status="myStatus" reRender="pageblock,errors,validationOK" oncomplete="setTable();validationOK(linesComplete);">
        <apex:param name="one" assignTo="{!numLines}" value="" />
        <apex:param name="validationOK" assignTo="{!validationOK}" value="" />
    </apex:actionFunction>
    <apex:actionFunction name="orderLines" action="{!orderLines}" status="myStatus" reRender="pageblock,errors,validationOK" oncomplete="setTable();validationOK(linesComplete);">
        <apex:param name="one" assignTo="{!idLines}" value="" />
        <apex:param name="two" assignTo="{!firstLine}" value="" />
        <apex:param name="validationOK" assignTo="{!validationOK}" value="" />
    </apex:actionFunction>
    <apex:actionFunction name="updateFilters" action="{!updateFilters}" status="myStatus" reRender="filtersblock,errors,generateLink">
    </apex:actionFunction>
    <apex:inputHidden value="{!queryString}" id="queryString"/>
    <apex:inputHidden value="{!validationOK}" id="validationOK"/>
    <div id="country_locations" style="display:none">
	    <apex:repeat value="{!alllocations}" var="location">
			<select size="1" master="{!location.Country}">
			    <apex:repeat value="{!location.locations}" var="lista">
				    <apex:repeat value="{!lista}" var="l">
						<option value="{!l.Value}">{!l.Label}</option>
					</apex:repeat>
				</apex:repeat>
			</select>
		</apex:repeat>
	</div>
    <div id="countries" style="display:none">
    <apex:selectList size="1">
        <apex:selectOptions value="{!allcountries}"/>
    </apex:selectList>
    </div>
    <apex:sectionHeader title="{!$ObjectType.Fee__c.labelPlural}" subtitle="Freight Rates Management"/>
        <apex:pageBlock mode="maindetail" id="filtersblock">
            <apex:pageBlockButtons location="top">
                <apex:commandButton value="Search Service Rates" status="myStatus" reRender="pageblock,errors,generateLink" action="{!resetList}" oncomplete="setTable();"/>
                <apex:outputLink value="NEU_Freight_Rates_Emails_save_pdf{!queryString}" id="generateLink" target="_blank" style="text-decoration:none">
                    <input value="Generate and Send PDF" type="button" class="btn"/>
                </apex:outputLink>
            </apex:pageBlockButtons>
            <apex:pageBlockButtons location="bottom">
           		<apex:outputLabel value="Date Historical Prices"/>
           		&nbsp;&nbsp;&nbsp;
           		<apex:inputfield value="{!filter_date.Valid_Until__c}"/>
           	</apex:pageBlockButtons>
            <div style="display:table-cell;vertical-align:top">
                <apex:pageBlockSection columns="2" showHeader="false" id="f2">
                    <apex:inputField id="Account_for" value="{!filter.Account_for__c}" onchange="updateFilters();"/>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="Show Rates"/>
                        <apex:selectList value="{!BuySell}" multiselect="false" size="1" onchange="updateFilters();">
                            <apex:selectOptions value="{!BuySellList}"/>
                        </apex:selectList>
                    </apex:pageBlockSectionItem>

                    <!--<apex:inputField value="{!filter.Fee_Category__c}"/>-->

					
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="Rate Category"/>
                        <apex:selectList value="{!filter.Fee_Category__c}" multiselect="false" size="1">
                            <apex:selectOptions value="{!rateCategoryList}"/>
                        </apex:selectList>
                    </apex:pageBlockSectionItem>


                    <apex:pageBlockSectionItem >
                    	<apex:outputLabel value="Currency"/>
                    	<apex:outputPanel layout="block" styleClass="requiredInput">
                    		<div class="requiredBlock"></div>
	                    	<apex:selectList value="{!filterCurrencyISOCode}" multiselect="false" size="1">
		                    	<apex:SelectOptions value="{!CurrencyISOCodeOptions}"/>
				        	</apex:selectList>
				       </apex:outputPanel>
				    </apex:pageBlockSectionItem>
                    <apex:inputField value="{!filter.Rate_Type__c}" onchange="updateFilters();"/>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="Show Breakpoints"/>
                        <apex:selectList value="{!DisplayMins}" multiselect="false" size="1">
                            <apex:SelectOptions value="{!displayMinslist}"/>
                        </apex:selectList>
                    </apex:pageBlockSectionItem>
					<apex:outputLabel />
                    <apex:pageBlockSectionItem id="DC" rendered="{!filter.Rate_Type__c=='Per Container'}">
                        <apex:outputLabel value="Display Concepts"/>
                        <apex:selectList id="DisplayConcepts" value="{!DisplayConcepts}" multiselect="false" size="1" onchange="updateFilters();">
                            <apex:selectOption itemValue="0" itemLabel="No Display"/>
                            <apex:selectOption itemValue="5" itemLabel="5 Concepts"/>
                            <apex:selectOption itemValue="4" itemLabel="4 Concepts"/>
                            <apex:selectOption itemValue="3" itemLabel="3 Concepts"/>
                            <apex:selectOption itemValue="2" itemLabel="2 Concepts"/>
                            <apex:selectOption itemValue="1" itemLabel="1 Concepts"/>
                        </apex:selectList>
                    </apex:pageBlockSectionItem>
                </apex:pageBlockSection>
            </div>
            <div style="display:table-cell;vertical-align:top">
                <apex:pageBlockSection columns="1" showHeader="false">
                    <apex:inputField value="{!filter.Carrier_Account__c}"/>
                    <apex:inputField value="{!filter.Valid_From__c}"/>
                    <apex:inputField value="{!filter.Valid_Until__c}"/>
                </apex:pageBlockSection>
            </div>
            <div style="display:table-cell;vertical-align:top">
                <apex:pageBlockSection columns="2" showHeader="false">
                    <apex:pageBlockSectionItem >
                    	<apex:outputLabel value="Region of Load"/>
	                    <apex:inputField value="{!loadFilter.Region__c}"/>
	                </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                    	<apex:outputLabel value="Region of Discharge"/>
	                    <apex:inputField value="{!dischargeFilter.Region__c}"/>
	                </apex:pageBlockSectionItem>
                    <apex:inputField value="{!filter.Route__r.Country_of_Load__c}"/>
                    <apex:inputField value="{!filter.Route__r.Country_of_Discharge__c}"/>
                    <apex:inputField value="{!filter.Route__r.Port_Airport_of_Load__c}"/>
                    <apex:inputField value="{!filter.Route__r.Port_Airport_of_Discharge__c}"/>
                </apex:pageBlockSection>
            </div>
            <apex:pageblocksection title="Information" columns="1">
            	<p class="leyenda"><img src="/img/icon/profile16.png" class="leyen_1"/><span class="texto_leyenda">Carrier Contact Information.</span></p>
                <p class="leyenda"><img src="/img/func_icons/util/editLayout20.png" class="leyen_2"/><span class="texto_leyenda">Historical Rates (All Time).</span></p>
                <p class="leyenda"><img src="/img/func_icons/util/datePicker16.gif" class="leyen_3"/><span class="texto_leyenda">Historical Rates (Since Date).</span></p>
            </apex:pageblocksection>
        </apex:pageBlock>
        <apex:pagemessages id="errors"/>
        <apex:pageBlock mode="maindetail" id="pageblock">
            <apex:pageBlockButtons >
                <apex:commandButton value="New Line" status="myStatus" reRender="pageblock,errors" action="{!addLine}" oncomplete="setTable();"/>
                <apex:commandButton value="Save" status="myStatus" reRender="pageblock,errors" action="{!saveData}" oncomplete="setTable();"/>
                <apex:commandButton value="Copy to Clipboard" html-oncopy="makeCopy(event);" onclick="launchCopy(this,event);return false;" reRender="errors"/>
                <apex:commandButton value="Reset" status="myStatus" reRender="pageblock,errors" action="{!resetList}" oncomplete="setTable();" immediate="true"/>
            </apex:pageBlockButtons>
<table class="list" id="mytable" border="0" cellpadding="0" cellspacing="0">
<tr class="headerRow">
	<th class="headerRow"><div onclick="sorting('Name');" class="copytoclipboard {!IF(compareField='Name',CompareClass,'compare')}">{!$ObjectType.Fee__c.fields.Name.Label}</div></th>
    <th class="headerRow"><div onclick="sorting('Fee_Category__c');" class="copytoclipboard {!IF(CompareField='Fee_Category__c',CompareClass,'compare')}">{!$ObjectType.Fee__c.fields.Fee_Category__c.Label}</div></th>
<apex:actionRegion rendered="{!filter.Fee_Category__c!='POD Charges'}">
	<th class="headerRow"><div onclick="sorting('Route__r.Country_of_Load__r.Name');" class="copytoclipboard {!IF(CompareField='Route__r.Country_of_Load__r.Name',CompareClass,'compare')}">{!$ObjectType.Carrier_Line_Load_Point__c.fields.Country_of_Load__c.Label}</div></th>
	<th class="headerRow"><div onclick="sorting('Route__r.Port_Airport_of_Load__r.Name');" class="copytoclipboard {!IF(CompareField='Route__r.Port_Airport_of_Load__r.Name',CompareClass,'compare')}">{!$ObjectType.Carrier_Line_Load_Point__c.fields.Port_Airport_of_Load__c.Label}</div></th>
</apex:actionRegion>
<apex:actionRegion rendered="{!filter.Fee_Category__c!='POL Charges'}">
	<th class="headerRow"><div onclick="sorting('Route__r.Country_of_Discharge__r.Name');" class="copytoclipboard {!IF(CompareField='Route__r.Country_of_Discharge__r.Name',CompareClass,'compare')}">{!$ObjectType.Carrier_Line_Load_Point__c.fields.Country_of_Discharge__c.Label}</div></th>
	<th class="headerRow"><div onclick="sorting('Route__r.Port_Airport_of_Discharge__r.Name');" class="copytoclipboard {!IF(CompareField='Route__r.Port_Airport_of_Discharge__r.Name',CompareClass,'compare')}">{!$ObjectType.Carrier_Line_Load_Point__c.fields.Port_Airport_of_Discharge__c.Label}</div></th>
</apex:actionRegion>
	<th class="headerRow"><div onclick="sorting('Carrier_Account__r.Name');" class="copytoclipboard {!IF(CompareField='Carrier_Account__r.Name',CompareClass,'compare')}">{!$ObjectType.Fee__c.fields.Carrier_Account__c.Label}</div></th>
	<th class="headerRow"><div onclick="sorting('TT_Days__c');" class="copytoclipboard {!IF(CompareField='TT_Days__c',CompareClass,'compare')}" style="text-align:center">{!$ObjectType.Fee__c.fields.TT_Days__c.Label}</div></th>
	<th class="headerRow"><div onclick="sorting('Valid_From__c');" class="copytoclipboard {!IF(CompareField='Valid_From__c',CompareClass,'compare')}">{!$ObjectType.Fee__c.fields.Valid_From__c.Label}</div></th>
	<th class="headerRow"><div onclick="sorting('Valid_Until__c');" class="copytoclipboard {!IF(CompareField='Valid_Until__c',CompareClass,'compare')}">{!$ObjectType.Fee__c.fields.Valid_Until__c.Label}</div></th>
<apex:actionRegion rendered="{!(DisplayMins==1)||(DisplayMins==3)}">
	<th class="headerRow"><div onclick="sorting('Max_Kgs__c');" class="copytoclipboard {!IF(CompareField='Max_Kgs__c',CompareClass,'compare')}" style="text-align:center">{!$ObjectType.Fee__c.fields.Max_Kgs__c.Label}</div></th>
</apex:actionRegion>
<apex:actionRegion rendered="{!(DisplayMins==2)||(DisplayMins==3)}">
	<th class="headerRow"><div onclick="sorting('Max_M3__c');" class="copytoclipboard {!IF(CompareField='Max_M3__c',CompareClass,'compare')}" style="text-align:center">{!$ObjectType.Fee__c.fields.Max_M3__c.Label}</div></th>
</apex:actionRegion>
<apex:actionRegion rendered="{!(DisplayMins>3)}">
	<th class="headerRow"><div onclick="sorting('Mins0');" class="copytoclipboard {!IF(CompareField='Mins0',CompareClass,'compare')}" style="text-align:center">Normal</div></th>
	<th class="headerRow">
		<div onclick="sorting('Mins1');" class="copytoclipboard {!IF(CompareField='Mins1',CompareClass,'compare')}">
			+<apex:inputText onclick="if(event.stopPropagation)event.stopPropagation();else event.cancelBubble=true;" value="{!TMin1}" html-placeholder="{!TMin1}" style="text-align:right;width:4em"/>Kg
		</div>
	</th>
	<apex:actionRegion rendered="{!(DisplayMins>4)}">
		<th class="headerRow">
        	<div onclick="sorting('Mins2');" class="copytoclipboard {!IF(CompareField='Mins2',CompareClass,'compare')}">
				+<apex:inputText onclick="if(event.stopPropagation)event.stopPropagation();else event.cancelBubble=true;" value="{!TMin2}" html-placeholder="{!TMin2}" style="text-align:right;width:4em"/>Kg
			</div>
		</th>
		<apex:actionRegion rendered="{!(DisplayMins>5)}">
			<th class="headerRow">
	        	<div onclick="sorting('Mins3');" class="copytoclipboard {!IF(CompareField='Mins3',CompareClass,'compare')}">
					+<apex:inputText onclick="if(event.stopPropagation)event.stopPropagation();else event.cancelBubble=true;" value="{!TMin3}" html-placeholder="{!TMin3}" style="text-align:right;width:4em"/>Kg
				</div>
			</th>
			<apex:actionRegion rendered="{!(DisplayMins>6)}">
				<th class="headerRow">
		        	<div onclick="sorting('Mins4');" class="copytoclipboard {!IF(CompareField='Mins4',CompareClass,'compare')}">
						+<apex:inputText onclick="if(event.stopPropagation)event.stopPropagation();else event.cancelBubble=true;" value="{!TMin4}" html-placeholder="{!TMin4}" style="text-align:right;width:4em"/>Kg
					</div>
				</th>
				<apex:actionRegion rendered="{!(DisplayMins>7)}">
					<th class="headerRow">
			        	<div onclick="sorting('Mins5');" class="copytoclipboard {!IF(CompareField='Mins5',CompareClass,'compare')}">
							+<apex:inputText onclick="if(event.stopPropagation)event.stopPropagation();else event.cancelBubble=true;" value="{!TMin5}" html-placeholder="{!TMin5}" style="text-align:right;width:4em"/>Kg
						</div>
					</th>
				</apex:actionRegion>
			</apex:actionRegion>
		</apex:actionRegion>
	</apex:actionRegion>
</apex:actionRegion>
<apex:actionRegion rendered="{!DisplayConcepts>0}">
    <th class="headerRow"><div onclick="sorting('Container_Type__r.Name');" class="copytoclipboard {!IF(CompareField='Container_Type__r.Name',CompareClass,'compare')}">{!$ObjectType.Fee__c.fields.Container_Type__c.Label}</div></th>
	<th class="headerRow">
		<div onclick="sorting('Cost_Concept_1__c');" class="{!IF(CompareField='Cost_Concept_1__c',CompareClass,'compare')}">
			<apex:inputText onclick="if(event.stopPropagation)event.stopPropagation();else event.cancelBubble=true;" value="{!Concept1}" html-placeholder="{!$ObjectType.Fee__c.fields.Concept_1__c.Label}" style="width:90%" styleClass="copytoclipboard"/>
        </div>
    </th>
	<apex:actionRegion rendered="{!DisplayConcepts>1}">
		<th class="headerRow">
			<div onclick="sorting('Cost_Concept_2__c');" class="{!IF(CompareField='Cost_Concept_2__c',CompareClass,'compare')}">
				<apex:inputText onclick="if(event.stopPropagation)event.stopPropagation();else event.cancelBubble=true;" value="{!Concept2}" html-placeholder="{!$ObjectType.Fee__c.fields.Concept_2__c.Label}" style="width:90%" styleClass="copytoclipboard"/>
			</div>
		</th>
		<apex:actionRegion rendered="{!DisplayConcepts>2}">
			<th class="headerRow">
				<div onclick="sorting('Cost_Concept_3__c');" class="{!IF(CompareField='Cost_Concept_3__c',CompareClass,'compare')}">
					<apex:inputText onclick="if(event.stopPropagation)event.stopPropagation();else event.cancelBubble=true;" value="{!Concept3}" html-placeholder="{!$ObjectType.Fee__c.fields.Concept_3__c.Label}" style="width:90%" styleClass="copytoclipboard"/>
				</div>
			</th>
			<apex:actionRegion rendered="{!DisplayConcepts>3}">
				<th class="headerRow">
					<div onclick="sorting('Cost_Concept_4__c');" class="{!IF(CompareField='Cost_Concept_4__c',CompareClass,'compare')}">
						<apex:inputText onclick="if(event.stopPropagation)event.stopPropagation();else event.cancelBubble=true;" value="{!Concept4}" html-placeholder="{!$ObjectType.Fee__c.fields.Concept_4__c.Label}" style="width:90%" styleClass="copytoclipboard"/>
					</div>
				</th>
				<apex:actionRegion rendered="{!DisplayConcepts>4}">
					<th class="headerRow">
						<div onclick="sorting('Cost_Concept_5__c');" class="{!IF(CompareField='Cost_Concept_5__c',CompareClass,'compare')}">
							<apex:inputText onclick="if(event.stopPropagation)event.stopPropagation();else event.cancelBubble=true;" value="{!Concept5}" html-placeholder="{!$ObjectType.Fee__c.fields.Concept_5__c.Label}" style="width:90%" styleClass="copytoclipboard"/>
						</div>
					</th>
				</apex:actionRegion>
			</apex:actionRegion>
		</apex:actionRegion>
	</apex:actionRegion>
</apex:actionRegion>
<apex:actionRegion rendered="{!((BuySell==1)||(BuySell==3))&&(filter.Rate_Type__c!='Per Container')&&(DisplayMins<=3)}">
	<th class="headerRow"><div onclick="sorting('Buy_Rate__c');" class="copytoclipboard {!IF(CompareField='Buy_Rate__c',CompareClass,'compare')}" style="text-align:center">{!$ObjectType.Fee__c.fields.Buy_Rate__c.Label}</div></th>
</apex:actionRegion>
<apex:actionRegion rendered="{!(BuySell==3)&&(filter.Rate_Type__c!='Per Container')&&(DisplayMins<=3)}">
	<th class="headerRow">
        <div>
            <div onclick="sorting('Margin0');" class="copytoclipboard {!IF(CompareField='Margin0',CompareClass,'compare')}" style="text-align:center;margin-bottom:3px">Margin (%)</div>
            <div><apex:inputText style="width:3em;text-align:right" styleClass="ap0"/><apex:image value="/img/func_icons/util/checkmark16.gif" onclick="applymargin(0);" title="Apply" style="cursor:pointer;vertical-align:middle"/></div>
        </div>
    </th>
</apex:actionRegion>
<apex:actionRegion rendered="{!((BuySell==2)||(BuySell==3))&&(filter.Rate_Type__c!='Per Container')&&(DisplayMins<=3)}">
    <th class="headerRow"><div onclick="sorting('Fee_Rate__c');" class="copytoclipboard {!IF(CompareField='Fee_Rate__c',CompareClass,'compare')}" style="text-align:center">{!$ObjectType.Fee__c.fields.Fee_Rate__c.Label}</div></th>
</apex:actionRegion>
<apex:actionRegion rendered="{!(filter.Rate_Type__c==null)||(filter.Rate_Type__c=='Per M3')||(filter.Rate_Type__c=='Per Kg')}">
    <th class="headerRow"><div onclick="sorting('Volumetric_Factor__c');" class="copytoclipboard {!IF(CompareField='Volumetric_Factor__c',CompareClass,'compare')}" style="text-align:center">{!$ObjectType.Fee__c.fields.Volumetric_Factor__c.Label}</div></th>
</apex:actionRegion>
<th class="headerRow"><div onclick="sorting('Min__c');" class="copytoclipboard {!IF(CompareField='Min__c',CompareClass,'compare')}" style="text-align:center">{!$ObjectType.Fee__c.fields.Min__c.Label}</div></th>
<apex:actionRegion rendered="{!filter.Rate_Type__c==null}">
    <th class="headerRow"><div onclick="sorting('Rate_Type__c');" class="copytoclipboard {!IF(CompareField='Rate_Type__c',CompareClass,'compare')}" style="text-align:center">{!$ObjectType.Fee__c.fields.Rate_Type__c.Label}</div></th>
</apex:actionRegion>
<apex:actionRegion rendered="{!((BuySell==1)||(BuySell==3))&&(filter.Rate_Type__c=='Per Container')&&(DisplayConcepts==0)}">
    <th class="headerRow"><div onclick="sorting('Buy_Rate1');" class="copytoclipboard {!IF(CompareField='Buy_Rate1',CompareClass,'compare')}" style="text-align:center">{!IF(BuySell==3,$ObjectType.Fee__c.fields.Buy_Rate__c.Label+' '+containerNames[0],containerNames[0])}</div></th>
</apex:actionRegion>

<apex:actionRegion rendered="{!(BuySell==3)&&(filter.Rate_Type__c=='Per Container')&&(DisplayConcepts==0)}">
    <th class="headerRow">
		<div>
			<div onclick="sorting('Margin1');" class="copytoclipboard {!IF(CompareField='Margin1',CompareClass,'compare')}" style="text-align:center;margin-bottom:3px">Margin (%)</div>
			<div><apex:inputText style="width:3em;text-align:right" styleClass="ap1"/><apex:image value="/img/func_icons/util/checkmark16.gif" onclick="applymargin(1);" title="Apply" style="cursor:pointer;vertical-align:middle"/></div>
		</div>
	</th>
</apex:actionRegion>
<apex:actionRegion rendered="{!((BuySell==2)||(BuySell==3))&&(filter.Rate_Type__c=='Per Container')&&(DisplayConcepts==0)}">
    <th class="headerRow"><div onclick="sorting('Sell_Rate1');" class="copytoclipboard {!IF(CompareField='Sell_Rate1',CompareClass,'compare')}" style="text-align:center">{!IF(BuySell==3,$ObjectType.Fee__c.fields.Fee_Rate__c.Label+' '+containerNames[0],containerNames[0])}</div></th>
</apex:actionRegion>
<apex:actionRegion rendered="{!((BuySell==1)||(BuySell==3))&&(filter.Rate_Type__c=='Per Container')&&(DisplayConcepts==0)}">
    <th class="headerRow"><div onclick="sorting('Buy_Rate2');" class="copytoclipboard {!IF(CompareField='Buy_Rate2',CompareClass,'compare')}" style="text-align:center">{!IF(BuySell==3,$ObjectType.Fee__c.fields.Buy_Rate__c.Label+' '+containerNames[1],containerNames[1])}</div></th>
</apex:actionRegion>
<apex:actionRegion rendered="{!(BuySell==3)&&(filter.Rate_Type__c=='Per Container')&&(DisplayConcepts==0)}">
    <th class="headerRow">
    	<div>
			<div onclick="sorting('Margin2');" class="copytoclipboard {!IF(CompareField='Margin2',CompareClass,'compare')}" style="text-align:center;margin-bottom:3px">Margin (%)</div>
			<div><apex:inputText style="width:3em;text-align:right" styleClass="ap2"/><apex:image value="/img/func_icons/util/checkmark16.gif" onclick="applymargin(2);" title="Apply" style="cursor:pointer;vertical-align:middle"/></div>
		</div>
	</th>
</apex:actionRegion>
<apex:actionRegion rendered="{!((BuySell==2)||(BuySell==3))&&(filter.Rate_Type__c=='Per Container')&&(DisplayConcepts==0)}">
    <th class="headerRow"><div onclick="sorting('Sell_Rate2');" class="copytoclipboard {!IF(CompareField='Sell_Rate2',CompareClass,'compare')}" style="text-align:center">{!IF(BuySell==3,$ObjectType.Fee__c.fields.Fee_Rate__c.Label+' '+containerNames[1],containerNames[1])}</div></th>
</apex:actionRegion>
<apex:actionRegion rendered="{!((BuySell==1)||(BuySell==3))&&(filter.Rate_Type__c=='Per Container')&&(DisplayConcepts==0)}">
    <th class="headerRow"><div onclick="sorting('Buy_Rate3');" class="copytoclipboard {!IF(CompareField='Buy_Rate3',CompareClass,'compare')}" style="text-align:center">{!IF(BuySell==3,$ObjectType.Fee__c.fields.Buy_Rate__c.Label+' '+containerNames[2],containerNames[2])}</div></th>
</apex:actionRegion>
<apex:actionRegion rendered="{!(BuySell==3)&&(filter.Rate_Type__c=='Per Container')&&(DisplayConcepts==0)}">
    <th class="headerRow">
    	<div>
			<div onclick="sorting('Margin3');" class="copytoclipboard {!IF(CompareField='Margin3',CompareClass,'compare')}" style="text-align:center;margin-bottom:3px">Margin (%)</div>
			<div><apex:inputText style="width:3em;text-align:right" styleClass="ap3"/><apex:image value="/img/func_icons/util/checkmark16.gif" onclick="applymargin(3);" title="Apply" style="cursor:pointer;vertical-align:middle"/></div>
		</div>
	</th>
</apex:actionRegion>
<apex:actionRegion rendered="{!((BuySell==2)||(BuySell==3))&&(filter.Rate_Type__c=='Per Container')&&(DisplayConcepts==0)}">
    <th class="headerRow"><div onclick="sorting('Sell_Rate3');" class="copytoclipboard {!IF(CompareField='Sell_Rate3',CompareClass,'compare')}" style="text-align:center">{!IF(BuySell==3,$ObjectType.Fee__c.fields.Fee_Rate__c.Label+' '+containerNames[2],containerNames[2])}</div></th>
</apex:actionRegion>
 <th class="headerRow"><div onclick="sorting('Comments__c');" class="copytoclipboard {!IF(CompareField='Comments__c',CompareClass,'compare')}">{!$ObjectType.Fee__c.fields.Comments__c.Label}</div></th>
 <th class="headerRow"><div onclick="sorting('Account_for__r.Name');" class="copytoclipboard {!IF(CompareField='Account_for__r.Name',CompareClass,'compare')}">{!$ObjectType.Fee__c.fields.Account_for__c.Label}</div></th>
</tr>
<apex:repeat value="{!myList}" var="line">
<tr class="dataRow" onmouseover="if (window.hiOn){hiOn(this);}" onmouseout="if (window.hiOff){hiOff(this);}" onblur="if (window.hiOff){hiOff(this);}" onfocus="if (window.hiOn){hiOn(this);}">
	<td class="dataCell">
		<div style="display:inline-block;width:185px">
            <apex:inputField value="{!line.fee0.Name}" html-onpaste="return handlepaste(this,event);" style="width:160px" styleClass="pname copytoclipboard" html-relatedTo=".Rate_Names_List" html-copystyle="width:140px"/>
            <apex:outputLink value="{!URLFOR($Action.Fee__c.View,line.fee0.Id)}" target="_blank" rendered="{!line.fee0.Id!=null}" style="float:right"><apex:image value="/img/apexpages/setup/launch.jpg" height="15" width="15"/></apex:outputLink>
		</div>
	</td>
	<td class="dataCell"><apex:inputField styleClass="Fee_Category" value="{!line.fee0.Fee_Category__c}" html-onpaste="return handlepaste(this,event);" style="width:8em" html-copyclass="copytoclipboard"/></td>
<apex:actionRegion rendered="{!filter.Fee_Category__c!='POD Charges'}">
	<td class="dataCell">
		<apex:selectList value="{!line.fee0.Route__r.Country_of_Load__c}" size="1" styleClass="Country_of_Load" html-onpaste="return handlepaste(this,event);" html-updateMaster=".Port_Airport_of_Load" html-copyclass="copytoclipboard">
        	<apex:selectOptions value="{!allcountries}"/>
        </apex:selectList>
    </td>
	<td class="dataCell"><apex:inputHidden value="{!line.fee0.Route__r.Port_Airport_of_Load__c}" html-class="Port_Airport_of_Load" html-onpaste="return handlepaste(this,event);" html-relatedTo="#country_locations" html-relatedToMaster="{!line.fee0.Route__r.Country_of_Load__c}" html-copyclass="copytoclipboard"/></td>
</apex:actionRegion>
<apex:actionRegion rendered="{!filter.Fee_Category__c!='POL Charges'}">
	<td class="dataCell">
		<apex:selectList value="{!line.fee0.Route__r.Country_of_Discharge__c}" size="1" styleClass="Country_of_Discharge" html-onpaste="return handlepaste(this,event);" html-updateMaster=".Port_Airport_of_Discharge" html-copyclass="copytoclipboard">
        	<apex:selectOptions value="{!allcountries}"/>
		</apex:selectList>
	</td> 
	<td class="dataCell"><apex:inputHidden value="{!line.fee0.Route__r.Port_Airport_of_Discharge__c}" html-class="Port_Airport_of_Discharge" html-onpaste="return handlepaste(this,event);" html-relatedTo="#country_locations" html-relatedToMaster="{!line.fee0.Route__r.Country_of_Discharge__c}" html-copyclass="copytoclipboard"/></td>
</apex:actionRegion>
	<td class="dataCell">
		<div class="carrier_account">
			<span class="campo_azul carrier_account_{!line.fee0.Id}" onclick="get_message('{!line.fee0.Id}','{!line.fee0.Carrier_Account__c}','carrier_info');"><img src="/img/icon/profile16.png" class="board_image"/></span>
			<apex:inputField value="{!line.fee0.Carrier_Account__c}" html-onpaste="return handlepaste(this,event);" style="width:8em" styleClass="copytoclipboard"/>
		</div>
	</td>
	<td class="dataCell"><apex:inputField value="{!line.fee0.TT_Days__c}" html-onpaste="return handlepaste(this,event);" style="width:6em;text-align:right" styleClass="copytoclipboard"/></td>
	<td class="dataCell"><apex:inputField value="{!line.fee0.Valid_From__c}" html-onpaste="return handlepaste(this,event);" style="width:6em" styleClass="copytoclipboard"/></td>
	<td class="dataCell"><apex:inputField value="{!line.fee0.Valid_Until__c}" html-onpaste="return handlepaste(this,event);" style="width:6em" styleClass="copytoclipboard"/></td>
<apex:actionRegion rendered="{!(DisplayMins==1)||(DisplayMins==3)}">
	<td class="dataCell"><apex:inputField value="{!line.fee0.Max_Kgs__c}" html-onpaste="return handlepaste(this,event);" style="width:6em;text-align:right" styleClass="copytoclipboard"/></td>
</apex:actionRegion>
<apex:actionRegion rendered="{!(DisplayMins==2)||(DisplayMins==3)}">
	<td class="dataCell"><apex:inputField value="{!line.fee0.Max_M3__c}" html-onpaste="return handlepaste(this,event);" style="width:6em;text-align:right" styleClass="copytoclipboard"/></td>
</apex:actionRegion>
<apex:actionRegion rendered="{!(DisplayMins>3)}">
	<td class="dataCell">
		<div class="carrier_account">
        	<span class="campo_azul buy_rate_1_{!line.fee1.Id}" onclick="get_message('{!line.fee1.Id}','{!line.fee1.Carrier_Account__c}','buy_rate_1');"><img src="/img/func_icons/util/editLayout20.png" class="board_image"/></span>
            <span class="campo_azul buy_rate_2_{!line.fee1.Id}" onclick="get_message('{!line.fee1.Id}','{!line.fee1.Carrier_Account__c}','buy_rate_2');"><img src="/img/func_icons/util/datePicker16.gif" class="board_image"/></span>
	        <apex:inputField value="{!line.fee1.Buy_Rate__c}" html-onpaste="return handlepaste(this,event);" style="width:6em;text-align:right" styleClass="b0 copytoclipboard"/>
		</div>
	</td>
	<td class="dataCell">
		<div class="carrier_account">
        	<span class="campo_azul buy_rate_1_{!line.fee2.Id}" onclick="get_message('{!line.fee2.Id}','{!line.fee2.Carrier_Account__c}','buy_rate_1');"><img src="/img/func_icons/util/editLayout20.png" class="board_image"/></span>
            <span class="campo_azul buy_rate_2_{!line.fee2.Id}" onclick="get_message('{!line.fee2.Id}','{!line.fee2.Carrier_Account__c}','buy_rate_2');"><img src="/img/func_icons/util/datePicker16.gif" class="board_image"/></span>
	        <apex:inputField value="{!line.fee2.Buy_Rate__c}" html-onpaste="return handlepaste(this,event);" style="width:6em;text-align:right" styleClass="b0 copytoclipboard"/>
		</div>
	</td>
	<apex:actionRegion rendered="{!(DisplayMins>4)}">
		<td class="dataCell">
			<div class="carrier_account">
        		<span class="campo_azul buy_rate_1_{!line.fee3.Id}" onclick="get_message('{!line.fee3.Id}','{!line.fee3.Carrier_Account__c}','buy_rate_1');"><img src="/img/func_icons/util/editLayout20.png" class="board_image"/></span>
            	<span class="campo_azul buy_rate_2_{!line.fee3.Id}" onclick="get_message('{!line.fee3.Id}','{!line.fee3.Carrier_Account__c}','buy_rate_2');"><img src="/img/func_icons/util/datePicker16.gif" class="board_image"/></span>
	        	<apex:inputField value="{!line.fee3.Buy_Rate__c}" html-onpaste="return handlepaste(this,event);" style="width:6em;text-align:right" styleClass="b0 copytoclipboard"/>
			</div>
		</td>
		<apex:actionRegion rendered="{!(DisplayMins>5)}">
			<td class="dataCell">
				<div class="carrier_account">
	        		<span class="campo_azul buy_rate_1_{!line.fee4.Id}" onclick="get_message('{!line.fee4.Id}','{!line.fee4.Carrier_Account__c}','buy_rate_1');"><img src="/img/func_icons/util/editLayout20.png" class="board_image"/></span>
	            	<span class="campo_azul buy_rate_2_{!line.fee4.Id}" onclick="get_message('{!line.fee4.Id}','{!line.fee4.Carrier_Account__c}','buy_rate_2');"><img src="/img/func_icons/util/datePicker16.gif" class="board_image"/></span>
		        	<apex:inputField value="{!line.fee4.Buy_Rate__c}" html-onpaste="return handlepaste(this,event);" style="width:6em;text-align:right" styleClass="b0 copytoclipboard"/>
				</div>
			</td>
			<apex:actionRegion rendered="{!(DisplayMins>6)}">
				<td class="dataCell">
					<div class="carrier_account">
		        		<span class="campo_azul buy_rate_1_{!line.fee5.Id}" onclick="get_message('{!line.fee5.Id}','{!line.fee5.Carrier_Account__c}','buy_rate_1');"><img src="/img/func_icons/util/editLayout20.png" class="board_image"/></span>
		            	<span class="campo_azul buy_rate_2_{!line.fee5.Id}" onclick="get_message('{!line.fee5.Id}','{!line.fee5.Carrier_Account__c}','buy_rate_2');"><img src="/img/func_icons/util/datePicker16.gif" class="board_image"/></span>
			        	<apex:inputField value="{!line.fee5.Buy_Rate__c}" html-onpaste="return handlepaste(this,event);" style="width:6em;text-align:right" styleClass="b0 copytoclipboard"/>
					</div>
				</td>
				<apex:actionRegion rendered="{!(DisplayMins>7)}">
					<td class="dataCell">
						<div class="carrier_account">
			        		<span class="campo_azul buy_rate_1_{!line.fee6.Id}" onclick="get_message('{!line.fee6.Id}','{!line.fee6.Carrier_Account__c}','buy_rate_1');"><img src="/img/func_icons/util/editLayout20.png" class="board_image"/></span>
			            	<span class="campo_azul buy_rate_2_{!line.fee6.Id}" onclick="get_message('{!line.fee6.Id}','{!line.fee6.Carrier_Account__c}','buy_rate_2');"><img src="/img/func_icons/util/datePicker16.gif" class="board_image"/></span>
				        	<apex:inputField value="{!line.fee6.Buy_Rate__c}" html-onpaste="return handlepaste(this,event);" style="width:6em;text-align:right" styleClass="b0 copytoclipboard"/>
						</div>
					</td>
				</apex:actionRegion>
			</apex:actionRegion>
		</apex:actionRegion>
	</apex:actionRegion>
</apex:actionRegion>
<apex:actionRegion rendered="{!DisplayConcepts>0}">
    <td class="dataCell"><apex:inputField value="{!line.fee0.Container_Type__c}" style="width:8em" styleClass="copytoclipboard"/></td>
	<td class="dataCell" style="text-align:right"><apex:inputField value="{!line.fee0.Cost_Concept_1__c}" html-onpaste="return handlepaste(this,event);" style="width:6em;text-align:right" styleClass="copytoclipboard"/></td>
	<apex:actionRegion rendered="{!DisplayConcepts>1}">
		<td class="dataCell" style="text-align:right"><apex:inputField value="{!line.fee0.Cost_Concept_2__c}" html-onpaste="return handlepaste(this,event);" style="width:6em;text-align:right" styleClass="copytoclipboard"/></td>
		<apex:actionRegion rendered="{!DisplayConcepts>2}">
			<td class="dataCell"><apex:inputField value="{!line.fee0.Cost_Concept_3__c}" html-onpaste="return handlepaste(this,event);" style="width:6em;text-align:right" styleClass="copytoclipboard"/></td>
			<apex:actionRegion rendered="{!DisplayConcepts>3}">
				<td class="dataCell"><apex:inputField value="{!line.fee0.Cost_Concept_4__c}" html-onpaste="return handlepaste(this,event);" style="width:6em;text-align:right" styleClass="copytoclipboard"/></td>
				<apex:actionRegion rendered="{!DisplayConcepts>4}">
					<td class="dataCell"><apex:inputField value="{!line.fee0.Cost_Concept_5__c}" html-onpaste="return handlepaste(this,event);" style="width:6em;text-align:right" styleClass="copytoclipboard"/></td>
				</apex:actionRegion>
			</apex:actionRegion>
		</apex:actionRegion>
	</apex:actionRegion>
</apex:actionRegion>
<apex:actionRegion rendered="{!((BuySell==1)||(BuySell==3))&&(filter.Rate_Type__c!='Per Container')&&(DisplayMins<=3)}">
    <td class="dataCell">
    	<div class="carrier_account">
        	<span class="campo_azul buy_rate_1_{!line.fee0.Id}" onclick="get_message('{!line.fee0.Id}','{!line.fee0.Carrier_Account__c}','buy_rate_1');"><img src="/img/func_icons/util/editLayout20.png" class="board_image"/></span>
            <span class="campo_azul buy_rate_2_{!line.fee0.Id}" onclick="get_message('{!line.fee0.Id}','{!line.fee0.Carrier_Account__c}','buy_rate_2');"><img src="/img/func_icons/util/datePicker16.gif" class="board_image"/></span>
	        <apex:inputField value="{!line.fee0.Buy_Rate__c}" html-onpaste="return handlepaste(this,event);" style="width:6em;text-align:right" styleClass="b0 buy0 copytoclipboard" onKeyUp="$(this).updateSellfBuy(0);"/>
		</div>
    </td>
</apex:actionRegion>
<apex:actionRegion rendered="{!(BuySell==3)&&(filter.Rate_Type__c!='Per Container')&&(DisplayMins<=3)}">
    <td class="dataCell"><apex:inputText value="{!line.Margin0}" html-onpaste="return handlepaste(this,event);" style="width:4em;text-align:right" styleClass="mg0 copytoclipboard" onKeyUp="$(this).updateSell(0);"/></td>
</apex:actionRegion>
<apex:actionRegion rendered="{!((BuySell==2)||(BuySell==3))&&(filter.Rate_Type__c!='Per Container')&&(DisplayMins<=3)}">
	<td class="dataCell">
		<div class="carrier_account">
        	<span class="campo_azul sell_rate_1_{!line.fee0.Id}" onclick="get_message('{!line.fee0.Id}','{!line.fee0.Carrier_Account__c}','sell_rate_1');"><img src="/img/func_icons/util/editLayout20.png" class="board_image"/></span>
            <span class="campo_azul sell_rate_2_{!line.fee0.Id}" onclick="get_message('{!line.fee0.Id}','{!line.fee0.Carrier_Account__c}','sell_rate_2');"><img src="/img/func_icons/util/datePicker16.gif" class="board_image"/></span>
            <apex:inputField value="{!line.fee0.Fee_Rate__c}" html-onpaste="return handlepaste(this,event);" style="width:6em;text-align:right" styleClass="s0 sell0 copytoclipboard" onKeyUp="$(this).updateMargin(0);"/>
        </div>
	</td>
</apex:actionRegion>
<apex:actionRegion rendered="{!(filter.Rate_Type__c==null)||(filter.Rate_Type__c=='Per M3')||(filter.Rate_Type__c=='Per Kg')}">
	<td class="dataCell"><apex:inputField value="{!line.fee0.Volumetric_Factor__c}" html-onpaste="return handlepaste(this,event);" style="width:6em;text-align:right" styleClass="copytoclipboard"/></td>
</apex:actionRegion>
	<td class="dataCell"><apex:inputField value="{!line.fee0.Min__c}" html-onpaste="return handlepaste(this,event);" style="width:6em;text-align:right" styleClass="copytoclipboard"/></td>
<apex:actionRegion rendered="{!filter.Rate_Type__c==null}">
	<td class="dataCell"><span class="Rate_Type"><apex:inputField value="{!line.fee0.Rate_Type__c}" html-onpaste="return handlepaste(this,event);" html-copyclass="copytoclipboard"/></span></td>
</apex:actionRegion>
<apex:actionRegion rendered="{!((BuySell==1)||(BuySell==3))&&(filter.Rate_Type__c=='Per Container')&&(DisplayConcepts==0)}">
	<td class="dataCell">
		<div class="carrier_account">
        	<span class="campo_azul buy_rate_1_{!line.fee1.Id}" onclick="get_message('{!line.fee1.Id}','{!line.fee1.Carrier_Account__c}','buy_rate_1');"><img src="/img/func_icons/util/editLayout20.png" class="board_image"/></span>
            <span class="campo_azul buy_rate_2_{!line.fee1.Id}" onclick="get_message('{!line.fee1.Id}','{!line.fee1.Carrier_Account__c}','buy_rate_2');"><img src="/img/func_icons/util/datePicker16.gif" class="board_image"/></span>
	        <apex:inputField value="{!line.fee1.Buy_Rate__c}" html-onpaste="return handlepaste(this,event);" style="width:6em;text-align:right" styleClass="b0 buy1 copytoclipboard" onKeyUp="$(this).updateSellfBuy(1);"/>
		</div>
	</td>
</apex:actionRegion>
<apex:actionRegion rendered="{!(BuySell==3)&&(filter.Rate_Type__c=='Per Container')&&(DisplayConcepts==0)}">
	<td class="dataCell"><apex:inputText value="{!line.Margin1}" html-onpaste="return handlepaste(this,event);" style="width:4em;text-align:right" styleClass="mg1 copytoclipboard" onKeyUp="$(this).updateSell(1);"/></td>
</apex:actionRegion>
<apex:actionRegion rendered="{!((BuySell==2)||(BuySell==3))&&(filter.Rate_Type__c=='Per Container')&&(DisplayConcepts==0)}">
	<td class="dataCell">
		<div class="carrier_account">
        	<span class="campo_azul sell_rate_1_{!line.fee1.Id}" onclick="get_message('{!line.fee1.Id}','{!line.fee1.Carrier_Account__c}','sell_rate_1');"><img src="/img/func_icons/util/editLayout20.png" class="board_image"/></span>
            <span class="campo_azul sell_rate_2_{!line.fee1.Id}" onclick="get_message('{!line.fee1.Id}','{!line.fee1.Carrier_Account__c}','sell_rate_2');"><img src="/img/func_icons/util/datePicker16.gif" class="board_image"/></span>
            <apex:inputField value="{!line.fee1.Fee_Rate__c}" html-onpaste="return handlepaste(this,event);" style="width:6em;text-align:right" styleClass="s0 sell1 copytoclipboard" onKeyUp="$(this).updateMargin(1);"/>
        </div>
	</td>
</apex:actionRegion>
<apex:actionRegion rendered="{!((BuySell==1)||(BuySell==3))&&(filter.Rate_Type__c=='Per Container')&&(DisplayConcepts==0)}">
	<td class="dataCell">
		<div class="carrier_account">
        	<span class="campo_azul buy_rate_1_{!line.fee2.Id}" onclick="get_message('{!line.fee2.Id}','{!line.fee2.Carrier_Account__c}','buy_rate_1');"><img src="/img/func_icons/util/editLayout20.png" class="board_image"/></span>
            <span class="campo_azul buy_rate_2_{!line.fee2.Id}" onclick="get_message('{!line.fee2.Id}','{!line.fee2.Carrier_Account__c}','buy_rate_2');"><img src="/img/func_icons/util/datePicker16.gif" class="board_image"/></span>
	        <apex:inputField value="{!line.fee2.Buy_Rate__c}" html-onpaste="return handlepaste(this,event);" style="width:6em;text-align:right" styleClass="b0 buy2 copytoclipboard" onKeyUp="$(this).updateSellfBuy(2);"/>
		</div>
	</td>
</apex:actionRegion>
<apex:actionRegion rendered="{!(BuySell==3)&&(filter.Rate_Type__c=='Per Container')&&(DisplayConcepts==0)}">
	<td class="dataCell"><apex:inputText value="{!line.Margin2}" html-onpaste="return handlepaste(this,event);" style="width:4em;text-align:right" styleClass="mg2 copytoclipboard" onKeyUp="$(this).updateSell(2);"/></td>
</apex:actionRegion>
<apex:actionRegion rendered="{!((BuySell==2)||(BuySell==3))&&(filter.Rate_Type__c=='Per Container')&&(DisplayConcepts==0)}">
	<td class="dataCell">
		<div class="carrier_account">
        	<span class="campo_azul sell_rate_1_{!line.fee2.Id}" onclick="get_message('{!line.fee2.Id}','{!line.fee2.Carrier_Account__c}','sell_rate_1');"><img src="/img/func_icons/util/editLayout20.png" class="board_image"/></span>
            <span class="campo_azul sell_rate_2_{!line.fee2.Id}" onclick="get_message('{!line.fee2.Id}','{!line.fee2.Carrier_Account__c}','sell_rate_2');"><img src="/img/func_icons/util/datePicker16.gif" class="board_image"/></span>
            <apex:inputField value="{!line.fee2.Fee_Rate__c}" html-onpaste="return handlepaste(this,event);" style="width:6em;text-align:right" styleClass="s0 sell2 copytoclipboard" onKeyUp="$(this).updateMargin(2);"/>
        </div>
	</td>
</apex:actionRegion>
<apex:actionRegion rendered="{!((BuySell==1)||(BuySell==3))&&(filter.Rate_Type__c=='Per Container')&&(DisplayConcepts==0)}">
	<td class="dataCell">
		<div class="carrier_account">
        	<span class="campo_azul buy_rate_1_{!line.fee3.Id}" onclick="get_message('{!line.fee3.Id}','{!line.fee3.Carrier_Account__c}','buy_rate_1');"><img src="/img/func_icons/util/editLayout20.png" class="board_image"/></span>
            <span class="campo_azul buy_rate_2_{!line.fee3.Id}" onclick="get_message('{!line.fee3.Id}','{!line.fee3.Carrier_Account__c}','buy_rate_2');"><img src="/img/func_icons/util/datePicker16.gif" class="board_image"/></span>
	        <apex:inputField value="{!line.fee3.Buy_Rate__c}" html-onpaste="return handlepaste(this,event);" style="width:6em;text-align:right" styleClass="b0 buy3 copytoclipboard" onKeyUp="$(this).updateSellfBuy(3);"/>
		</div>
	</td>
</apex:actionRegion>
<apex:actionRegion rendered="{!(BuySell==3)&&(filter.Rate_Type__c=='Per Container')&&(DisplayConcepts==0)}">
	<td class="dataCell"><apex:inputText value="{!line.Margin3}" html-onpaste="return handlepaste(this,event);" style="width:4em;text-align:right" styleClass="mg3 copytoclipboard" onKeyUp="$(this).updateSell(3);"/></td>
</apex:actionRegion>
<apex:actionRegion rendered="{!((BuySell==2)||(BuySell==3))&&(filter.Rate_Type__c=='Per Container')&&(DisplayConcepts==0)}">
	<td class="dataCell">
		<div class="carrier_account">
        	<span class="campo_azul sell_rate_1_{!line.fee3.Id}" onclick="get_message('{!line.fee3.Id}','{!line.fee3.Carrier_Account__c}','sell_rate_1');"><img src="/img/func_icons/util/editLayout20.png" class="board_image"/></span>
            <span class="campo_azul sell_rate_2_{!line.fee3.Id}" onclick="get_message('{!line.fee3.Id}','{!line.fee3.Carrier_Account__c}','sell_rate_2');"><img src="/img/func_icons/util/datePicker16.gif" class="board_image"/></span>
            <apex:inputField value="{!line.fee3.Fee_Rate__c}" html-onpaste="return handlepaste(this,event);" style="width:6em;text-align:right" styleClass="s0 sell3 copytoclipboard" onKeyUp="$(this).updateMargin(3);"/>
        </div>
	</td>
</apex:actionRegion>
	<td class="dataCell"><apex:inputField value="{!line.fee0.Comments__c}" style="width:12em" styleClass="copytoclipboard"/></td>
	<td class="dataCell"><apex:inputField value="{!line.fee0.Account_for__c}" style="width:8em" styleClass="copytoclipboard"/></td>
</tr>
</apex:repeat>
</table>
        </apex:pageBlock>
       <apex:actionstatus id="myStatus">
           <apex:facet name="start">
               <div class="waitingSearchDiv" id="el_loading" style="background-color: #fbfbfb;
                      height: 100%;opacity:0.65;width:100%;"> 
                   <div class="waitingHolder" style="top: 74.2px; width: 91px;">
                       <img class="waitingImage" src="/img/loading.gif" title="Please Wait..." />
                       <span class="waitingDescription">Loading...</span>
                   </div>
               </div>
           </apex:facet>
       </apex:actionstatus>
       <div id="alert_message" class="mruHoverDetail alert_message">
	    	<div id="custom_style_right" class="bPageBlock brandSecondaryBrd secondaryPalette">
	    		<div id="custom_style_header" class="pbHeader brandSecondaryBrd"><apex:outputtext value="{!message_header}" id="message_header" styleclass="main_header"/><span class="cierre" onclick="close_message();">X</span></div>
	    		<div id="custom_style_body" class="pbBody">
	    			<div class="main_info"><apex:outputtext value="{!message_data}" escape="false" id="message_data"/></div>
	    			<apex:outputpanel >
				    	<apex:actionstatus id="myStatus_div">
				        	<apex:facet name="start">
				               	<div class="waitingSearchDiv" id="el_loading" style="background-color: #fbfbfb; height: 100%;opacity:0.65; width: 370px; margin: 0 0 0 21px;"> 
				                   	<div class="waitingHolder" style="width: 91px;">
				                       	<img class="waitingImage" src="/img/loading.gif" title="Please Wait..." />
				                       	<span class="waitingDescription">Loading...</span>
				                   	</div>
				               	</div>
				           	</apex:facet>
				       	</apex:actionstatus>
				   	</apex:outputpanel>
	    		</div>
	    		<div id="custom_style_footer" class="pbFooter secondaryPalette">
	    			<div class="bg"></div>
	    		</div>
	    	</div>
	    </div>
	    <apex:actionFunction name="get_historical_prices" action="{!get_historical_prices}" reRender="message_data, message_header" status="myStatus_div" oncomplete="show_message();"/>
	    <apex:actionFunction name="get_carrier_contact_details" action="{!get_carrier_contact_details}" reRender="message_data, message_header" status="myStatus_div" oncomplete="show_message();"/>
	    <apex:inputhidden value="{!id_service}" id="id_service"/>
       	<apex:inputhidden value="{!id_carrier}" id="id_carrier"/>
       	<apex:inputhidden value="{!info_type}" id="info_type"/>
       	<apex:inputhidden value="{!buy_rate_filter}" id="buy_rate_filter"/>
       	<apex:inputhidden value="{!sell_rate_filter}" id="sell_rate_filter"/>
    </apex:form>
    <div id='pastediv' style="display:none"></div>
</apex:page>